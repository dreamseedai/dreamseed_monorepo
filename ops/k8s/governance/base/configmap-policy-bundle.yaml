apiVersion: v1
kind: ConfigMap
metadata:
  name: governance-policy-bundle
  namespace: governance
  annotations:
    policy.version: "1.0.0"
    policy.environment: "production"
data:
  policy.json: |
    {
        "bundles": {
            "access_control": {
                "revision": "1.0.0",
                "modules": {
                    "access_control.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5hY2Nlc3NfY29udHJvbAoKIyDsl63tlaAg6riw67CYIOygkeq3vCDsoJzslrQgKFJCQUMpIOygleyxhQpkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg6rSA66as7J6QIC0g66qo65OgIOyVoeyFmCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJhZG1pbiIKfQoKIyDqtZDsgqwgLSDroIjsiqgg7J296riwIO2XiOyaqQphbGxvdyB7CiAgICBpbnB1dC51c2VyLnJvbGUgPT0gInRlYWNoZXIiCiAgICBpbnB1dC5yZXNvdXJjZS50eXBlID09ICJsZXNzb24iCiAgICBpbnB1dC5hY3Rpb24gPT0gInJlYWQiCn0KCiMg6rWQ7IKsIC0g66CI7IqoIOyCreygnCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJ0ZWFjaGVyIgogICAgaW5wdXQucmVzb3VyY2UudHlwZSA9PSAibGVzc29uIgogICAgaW5wdXQuYWN0aW9uID09ICJkZWxldGUiCn0KCiMg7ZWZ7IOdIC0g7J6Q6riwIO2VmeuFhOyXkCDrp57ripQg66CI7IqoIOydveq4sCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJzdHVkZW50IgogICAgaW5wdXQucmVzb3VyY2UudHlwZSA9PSAibGVzc29uIgogICAgaW5wdXQuYWN0aW9uID09ICJyZWFkIgogICAgaXNfZ3JhZGVfYXBwcm9wcmlhdGUoaW5wdXQudXNlciwgaW5wdXQucmVzb3VyY2UpCn0KCiMgSGVscGVyOiDtlZnsg50g7ZWZ64WE6rO8IOugiOyKqCDtlZnrhYQg67KU7JyEIOu5hOq1kAppc19ncmFkZV9hcHByb3ByaWF0ZSh1c2VyLCByZXNvdXJjZSkgewogICAgdXNlci5ncmFkZSA+PSByZXNvdXJjZS5taW5fZ3JhZGUKICAgIHVzZXIuZ3JhZGUgPD0gcmVzb3VyY2UubWF4X2dyYWRlCn0K"
                }
            },
            "ai_content": {
                "revision": "1.0.0",
                "modules": {
                    "ai_content_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5haV9jb250ZW50X3BvbGljeQoKIyBBSSDsvZjthZDsuKAg7KCV7LGFOiDrtoDsoIHsoIjtlZwg7L2Y7YWQ7LigIO2VhO2EsOungQpkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg6riI7KeA7Ja0IOuqqeuhnQpmb3JiaWRkZW5fd29yZHMgPSB7ImJhZHdvcmQxIiwgImJhZHdvcmQyIiwgImJhZHdvcmQzIn0KCiMg66+86rCQIOyjvOygnCDrqqnroZ0Kc2Vuc2l0aXZlX3RvcGljcyA9IHsicG9saXRpY3MiLCAicmVsaWdpb24iLCAic2V4IiwgInZpb2xlbmNlIn0KCiMg6riI7KeA7Ja0IOqwkOyngApmb3JiaWRkZW5fd29yZF9kZXRlY3RlZCB7CiAgICBmb3JiaWRkZW5fd29yZCA6PSBmb3JiaWRkZW5fd29yZHNbX10KICAgIGNvbnRhaW5zKGxvd2VyKGlucHV0LmNvbnRlbnQpLCBmb3JiaWRkZW5fd29yZCkKfQoKIyDrr7zqsJAg7KO87KCcIOqwkOyngApzZW5zaXRpdmVfdG9waWNfZGV0ZWN0ZWQgewogICAgdG9waWMgOj0gc2Vuc2l0aXZlX3RvcGljc1tfXQogICAgY29udGFpbnMobG93ZXIoaW5wdXQuY29udGVudCksIHRvcGljKQp9CgojIO2VmeuFhCDsoIHtlanshLEg7JyE67CYICjsmIg6IOy9mO2FkOy4oCDrk7HquInsnbQg7IKs7Jqp7J6QIO2VmeuFhOuztOuLpCDrhpLsnYwpCmFnZV9pbmFwcHJvcHJpYXRlIHsKICAgIGlucHV0LnVzZXIuZ3JhZGUgPCBpbnB1dC5jb250ZW50Lm1pbl9ncmFkZQp9CgojIOuqqOuToCDsnITrsJgg7KGw6rG07J20IOyXhuydhCDqsr3smrDrp4wg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCBmb3JiaWRkZW5fd29yZF9kZXRlY3RlZAogICAgbm90IHNlbnNpdGl2ZV90b3BpY19kZXRlY3RlZAogICAgbm90IGFnZV9pbmFwcHJvcHJpYXRlCn0K"
                }
            },
            "ai_behavior": {
                "revision": "1.0.0",
                "modules": {
                    "ai_behavior_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5haV9iZWhhdmlvcl9wb2xpY3kKCiMgQUkg7ZaJ64+ZIOygleyxhTogQUkg7J2R64u1IO2WieuPmSDsoJztlZwKZGVmYXVsdCBhbGxvdyA9IGZhbHNlCgojIOydkeuLtSDquLjsnbQg7KCc7ZWcICjsmIg6IDEwMDDsnpAg7J247ZWYKQpyZXNwb25zZV90b29fbG9uZyB7CiAgICBpbnB1dC5yZXNwb25zZV9sZW5ndGggIT0gbnVsbAogICAgaW5wdXQucmVzcG9uc2VfbGVuZ3RoID4gMTAwMAp9CgojIOyZuOu2gCDrp4Htgawg7Y+s7ZWoIOyXrOu2gApleHRlcm5hbF9saW5rX2RldGVjdGVkIHsKICAgIGNvbnRhaW5zKGxvd2VyKGlucHV0LmNvbnRlbnQpLCAiaHR0cDovLyIpIAogICAgb3IgY29udGFpbnMobG93ZXIoaW5wdXQuY29udGVudCksICJodHRwczovLyIpCn0KCiMg7ZWZ7IOdIOqzvOygnCDrjIDtlokg7JqU7LKtIOqwkOyngCAo7JiIOiBhc3NpZ25tZW50IO2UjOuemOq3uOqwgCB0cnVl7J28IOqyveyasCkKYXNzaWdubWVudF9yZXF1ZXN0IHsKICAgIGlucHV0LnVzZXIucm9sZSA9PSAic3R1ZGVudCIKICAgIGlucHV0LnJlcXVlc3RfdHlwZSA9PSAiYXNzaWdubWVudF9oZWxwIgp9CgojIOuqqOuToCDsnITrsJgg7KGw6rG07J20IOyXhuydhCDqsr3smrDrp4wg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCByZXNwb25zZV90b29fbG9uZwogICAgbm90IGV4dGVybmFsX2xpbmtfZGV0ZWN0ZWQKICAgIG5vdCBhc3NpZ25tZW50X3JlcXVlc3QKfQo="
                }
            },
            "approval": {
                "revision": "1.0.0",
                "modules": {
                    "approval_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5hcHByb3ZhbF9wb2xpY3kKCiMg7Iq57J24IOybjO2BrO2UjOuhnOyasCDsoJXssYU6IOqzoOychO2XmCDslaHshZjsl5Ag64yA7ZWcIOyKueyduCDsmpTqtawKZGVmYXVsdCBhbGxvdyA9IGZhbHNlCgojIOqzoOychO2XmCDslaHshZgg66qp66GdCmhpZ2hfcmlza19hY3Rpb25zID0geyJkZWxldGVfdXNlciIsICJtb2RpZnlfcGVybWlzc2lvbnMiLCAiYWNjZXNzX2NvbmZpZGVudGlhbF9kYXRhIn0KCmhpZ2hfcmlza19hY3Rpb24gewogICAgaW5wdXQuYWN0aW9uICE9IG51bGwKICAgIGhpZ2hfcmlza19hY3Rpb25zW2lucHV0LmFjdGlvbl0KfQoKIyDsirnsnbgg7Jyg7Zqo7ISxOiDsirnsnbjsnpDqsIAg6rSA66as7J6Q7J2066mwIOyKueyduCDtlIzrnpjqt7jqsIAg7J6I7J2MCmFwcHJvdmFsX3ZhbGlkIHsKICAgIGlucHV0LmFwcHJvdmFsLmFwcHJvdmVkID09IHRydWUKICAgIGlucHV0LmFwcHJvdmFsLmFwcHJvdmVyLnJvbGUgPT0gImFkbWluIgp9CgojIOqzoOychO2XmCDslaHshZjsnbQg7JWE64uI66m0IO2XiOyaqQphbGxvdyB7CiAgICBub3QgaGlnaF9yaXNrX2FjdGlvbgp9CgojIOqzoOychO2XmCDslaHshZjsnbgg6rK97JqwIOyggeygiO2VnCDsirnsnbgg7J6I7Jy866m0IO2XiOyaqQphbGxvdyB7CiAgICBoaWdoX3Jpc2tfYWN0aW9uCiAgICBhcHByb3ZhbF92YWxpZAp9Cg=="
                }
            },
            "data_protection": {
                "revision": "1.0.0",
                "modules": {
                    "data_protection.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5kYXRhX3Byb3RlY3Rpb24KCiMg642w7J207YSwIOuztO2YuCDsoJXssYU6IOqwnOyduOygleuztCDrsI8g642w7J207YSwIOuztOyhtApkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg66+86rCQIOuNsOydtO2EsCDsoJHqt7wgKOqwnOyduOygleuztCDrk7EpIC0g6rWQ7IKsIOuYkOuKlCDqtIDrpqzsnpDrp4wg7ZeI7JqpCnNlbnNpdGl2ZV9kYXRhX2FjY2VzcyB7CiAgICBpbnB1dC5yZXNvdXJjZS50eXBlID09ICJwZXJzb25hbF9pbmZvIgogICAgbm90IChpbnB1dC51c2VyLnJvbGUgPT0gInRlYWNoZXIiIG9yIGlucHV0LnVzZXIucm9sZSA9PSAiYWRtaW4iKQp9CgojIO2Vmeu2gOuqqCDrj5nsnZgg7ZWE7JqU7ZWcIOqyveyasCAtIOuPmeydmCDsl4bsnLzrqbQg6rGw67aACm5vX3BhcmVudGFsX2NvbnNlbnQgewogICAgaW5wdXQucmVzb3VyY2UucmVxdWlyZXNfcGFyZW50X2NvbnNlbnQgPT0gdHJ1ZQogICAgaW5wdXQudXNlci5yb2xlID09ICJzdHVkZW50IgogICAgbm90IGlucHV0LnVzZXIucGFyZW50X2NvbnNlbnQKfQoKIyDrjbDsnbTthLAg67O07KG0IOq4sOqwhCDstIjqs7wgLSDrp4zro4wg642w7J207YSwIOygkeq3vCDsi5wg6rGw67aACmRhdGFfZXhwaXJlZCB7CiAgICBpbnB1dC5yZXNvdXJjZS5hZ2VfZGF5cyAhPSBudWxsCiAgICBpbnB1dC5yZXNvdXJjZS5hZ2VfZGF5cyA+IDM2NQp9CgojIOuqqOuToCDsnITrsJgg7KGw6rG07J20IOyXhuydhCDqsr3smrDrp4wg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCBzZW5zaXRpdmVfZGF0YV9hY2Nlc3MKICAgIG5vdCBub19wYXJlbnRhbF9jb25zZW50CiAgICBub3QgZGF0YV9leHBpcmVkCn0K"
                }
            },
            "rate_limit": {
                "revision": "1.0.0",
                "modules": {
                    "rate_limit.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5yYXRlX2xpbWl0CgojIOyCrOyaqeufiSDsoJztlZwg7KCV7LGFOiBBUEkg7Zi47LacIOuwjSDsnpDsm5Ag7IKs7JqpIOygnO2VnApkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg7ZWY66OoIEFQSSDtmLjstpwg7Zqf7IiYIOygnO2VnCAo7JiIOiAxMDAw7ZqMKQpvdmVyX3JhdGVfbGltaXQgewogICAgaW5wdXQudXNlci5hcGlfY2FsbHNfdG9kYXkgIT0gbnVsbAogICAgaW5wdXQudXNlci5hcGlfY2FsbHNfdG9kYXkgPiAxMDAwCn0KCiMgQUkg7Yqc7YSwIOyEuOyFmCDsi5zqsIQg7KCc7ZWcICjsmIg6IDYw67aEKQpzZXNzaW9uX3RpbWVfZXhjZWVkZWQgewogICAgaW5wdXQuc2Vzc2lvbi5kdXJhdGlvbl9taW51dGVzICE9IG51bGwKICAgIGlucHV0LnNlc3Npb24uZHVyYXRpb25fbWludXRlcyA+IDYwCn0KCiMg7J6Q7JuQIOyCrOyaqeufiSDsv7zthLAg7LSI6rO8CnF1b3RhX2V4Y2VlZGVkIHsKICAgIGlucHV0LnVzZXIucXVvdGEgIT0gbnVsbAogICAgaW5wdXQudXNlci51c2FnZSAhPSBudWxsCiAgICBpbnB1dC51c2VyLnVzYWdlID4gaW5wdXQudXNlci5xdW90YQp9CgojIOuqqOuToCDsnITrsJgg7KGw6rG07J20IOyXhuydhCDqsr3smrDrp4wg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCBvdmVyX3JhdGVfbGltaXQKICAgIG5vdCBzZXNzaW9uX3RpbWVfZXhjZWVkZWQKICAgIG5vdCBxdW90YV9leGNlZWRlZAp9Cg=="
                }
            }
        }
    }
