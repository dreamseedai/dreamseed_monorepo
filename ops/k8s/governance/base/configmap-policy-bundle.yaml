apiVersion: v1
kind: ConfigMap
metadata:
  name: governance-policy-bundle
  namespace: governance
  annotations:
    policy.version: "1.0.0"
    policy.environment: "production"
data:
  policy.json: |
    {
        "bundles": {
            "rate_limit": {
                "revision": "1.0.0",
                "modules": {
                    "rate_limit.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5yYXRlX2xpbWl0CgojIOyCrOyaqeufiSDsoJztlZwg7KCV7LGFOiBBUEkg7Zi47LacIOuwjyDsnpDsm5Ag7IKs7JqpIOygnO2VnApkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg7ZWY66OoIEFQSSDtmLjstpwg7Zqf7IiYIOygnO2VnCAo7JiIOiAxMDAw7ZqMKQpvdmVyX3JhdGVfbGltaXQgewogICAgaW5wdXQudXNlci5hcGlfY2FsbHNfdG9kYXkgIT0gbnVsbAogICAgaW5wdXQudXNlci5hcGlfY2FsbHNfdG9kYXkgPiAxMDAwCn0KCiMgQUkg7Yqc7YSwIOyEuOyFmCDsi5zqsIQg7KCc7ZWcICjsmIg6IDYw67aEKQpzZXNzaW9uX3RpbWVfZXhjZWVkZWQgewogICAgaW5wdXQuc2Vzc2lvbi5kdXJhdGlvbl9taW51dGVzICE9IG51bGwKICAgIGlucHV0LnNlc3Npb24uZHVyYXRpb25fbWludXRlcyA+IDYwCn0KCiMg7J6Q7JuQIOyCrOyaqeufiSDsv7zthLAg7LSI6rO8CnF1b3RhX2V4Y2VlZGVkIHsKICAgIGlucHV0LnVzZXIucXVvdGEgIT0gbnVsbAogICAgaW5wdXQudXNlci51c2FnZSAhPSBudWxsCiAgICBpbnB1dC51c2VyLnVzYWdlID4gaW5wdXQudXNlci5xdW90YQp9CgojIOuqqOuToCDsnITrsJgg7KGw6rG07J20IOyXhuydhCDqsr3smrDrp4wg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCBvdmVyX3JhdGVfbGltaXQKICAgIG5vdCBzZXNzaW9uX3RpbWVfZXhjZWVkZWQKICAgIG5vdCBxdW90YV9leGNlZWRlZAp9Cg=="
                }
            },
            "data_protection": {
                "revision": "1.0.0",
                "modules": {
                    "data_protection.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5kYXRhX3Byb3RlY3Rpb24KCiMg642w7J207YSwIOuztO2YuCDsoJXssYU6IOqwnOyduOygleuztCDsoJHqt7wg7KCc7Ja0IOuwjyDrjbDsnbTthLAg67O07KG0IO2ZleyduApkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg66+86rCQIOuNsOydtO2EsCDsoJHqt7wgLSDqtZDsgqwg65iQ64qUIOq0gOumrOyekOunjCDtl4jsmqkKc2Vuc2l0aXZlX2RhdGFfYWNjZXNzIHsKICAgIGlucHV0LnJlc291cmNlLnR5cGUgPT0gInBlcnNvbmFsX2luZm8iCiAgICBpbnB1dC51c2VyLnJvbGUgIT0gInRlYWNoZXIiCiAgICBpbnB1dC51c2VyLnJvbGUgIT0gImFkbWluIgp9CgojIO2Vmeu2gOuqqCDrj5nsnZgg7ZWE7JqU7ZWcIOqyveyasCAtIO2VmeyDneyXkOqyjCDrj5nsnZgg7JeG7Jy866m0IOqxsOu2gApub19wYXJlbnRhbF9jb25zZW50IHsKICAgIGlucHV0LnJlc291cmNlLnJlcXVpcmVzX3BhcmVudF9jb25zZW50ID09IHRydWUKICAgIGlucHV0LnVzZXIucm9sZSA9PSAic3R1ZGVudCIKICAgIG5vdCBpbnB1dC51c2VyLnBhcmVudF9jb25zZW50Cn0KCiMg642w7J207YSwIOuztOyhtCDquLDqsIQg7LSI6rO8IC0g66eM66OM65CcIOuNsOydtO2EsCDsoJHqt7wg7IucIOqxsOu2gApkYXRhX2V4cGlyZWQgewogICAgaW5wdXQucmVzb3VyY2UuYWdlX2RheXMgIT0gbnVsbAogICAgaW5wdXQucmVzb3VyY2UuYWdlX2RheXMgPiAzNjUKfQoKIyDrqqjrk6Ag7JyE67CYIOyhsOqxtOydtCDsl4bsnYQg6rK97Jqw66eMIO2XiOyaqQphbGxvdyB7CiAgICBub3Qgc2Vuc2l0aXZlX2RhdGFfYWNjZXNzCiAgICBub3Qgbm9fcGFyZW50YWxfY29uc2VudAogICAgbm90IGRhdGFfZXhwaXJlZAp9Cg=="
                }
            },
            "ai_behavior": {
                "revision": "1.0.0",
                "modules": {
                    "ai_behavior_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5haV9iZWhhdmlvcl9wb2xpY3kKCiMgQUkg7ZaJ64+ZIOygleyxhTogQUkg7J2R64u1IO2WieuPmSDsoJztlZwKZGVmYXVsdCBhbGxvdyA9IGZhbHNlCgojIOydkeuLtSDquLjsnbQg7KCc7ZWcICjsmIg6IDEwMDDsnpAg7J207ZWYKQpyZXNwb25zZV90b29fbG9uZyB7CiAgICBpbnB1dC5yZXNwb25zZV9sZW5ndGggIT0gbnVsbAogICAgaW5wdXQucmVzcG9uc2VfbGVuZ3RoID4gMTAwMAp9CgojIOyZuOu2gCDrp4Htgawg7Y+s7ZWoIOqwkOyngApleHRlcm5hbF9saW5rX2RldGVjdGVkIHsKICAgIGNvbnRhaW5zKGxvd2VyKGlucHV0LmNvbnRlbnQpLCAiaHR0cDovLyIpCn0KCmV4dGVybmFsX2xpbmtfZGV0ZWN0ZWQgewogICAgY29udGFpbnMobG93ZXIoaW5wdXQuY29udGVudCksICJodHRwczovLyIpCn0KCiMg7ZWZ7IOd7J2YIOqzvOygnCDrjIDtlokg7JqU7LKtIOqwkOyngCAoYXNzaWdubWVudF9oZWxwIO2UjOuemOq3uOuhnCDsoITri6zrkJjripQg6rK97JqwKQphc3NpZ25tZW50X3JlcXVlc3QgewogICAgaW5wdXQudXNlci5yb2xlID09ICJzdHVkZW50IgogICAgaW5wdXQucmVxdWVzdF90eXBlID09ICJhc3NpZ25tZW50X2hlbHAiCn0KCiMg66qo65OgIOychOuwmCDsobDqsbTsnbQg7JeG7J2EIOqyveyasOunjCDtl4jsmqkKYWxsb3cgewogICAgbm90IHJlc3BvbnNlX3Rvb19sb25nCiAgICBub3QgZXh0ZXJuYWxfbGlua19kZXRlY3RlZAogICAgbm90IGFzc2lnbm1lbnRfcmVxdWVzdAp9Cg=="
                }
            },
            "ai_content": {
                "revision": "1.0.0",
                "modules": {
                    "ai_content_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5haV9jb250ZW50X3BvbGljeQoKIyBBSSDsvZjthZDsuKAg7KCV7LGFOiDrtoDsoIHsoIjtlZwg7L2Y7YWQ7LigIO2VhO2EsOungQpkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg6riI7KeA7Ja0IOuqqeuhnQpmb3JiaWRkZW5fd29yZHMgPSB7ImJhZHdvcmQxIiwgImJhZHdvcmQyIiwgImJhZHdvcmQzIn0KCiMg66+86rCQIOyjvOygnCDrqqnroZ0Kc2Vuc2l0aXZlX3RvcGljcyA9IHsicG9saXRpY3MiLCAicmVsaWdpb24iLCAic2V4IiwgInZpb2xlbmNlIn0KCiMg6riI7KeA7Ja0IOqwkOyngApmb3JiaWRkZW5fd29yZF9kZXRlY3RlZCB7CiAgICBmb3JiaWRkZW5fd29yZCA6PSBmb3JiaWRkZW5fd29yZHNbX10KICAgIGNvbnRhaW5zKGxvd2VyKGlucHV0LmNvbnRlbnQpLCBmb3JiaWRkZW5fd29yZCkKfQoKIyDrr7zqsJAg7KO87KCcIOqwkOyngApzZW5zaXRpdmVfdG9waWNfZGV0ZWN0ZWQgewogICAgdG9waWMgOj0gc2Vuc2l0aXZlX3RvcGljc1tfXQogICAgY29udGFpbnMobG93ZXIoaW5wdXQuY29udGVudCksIHRvcGljKQp9CgojIO2VmeuFhCDsoIHtlanshLEg7JyE67CYICjsgqzsmqnsnpAg7ZWZ64WE67O064ukIOuGkuydgCDsvZjthZDsuKAg65Ox6riJKQphZ2VfaW5hcHByb3ByaWF0ZSB7CiAgICBpbnB1dC51c2VyLmdyYWRlIDwgaW5wdXQuY29udGVudC5taW5fZ3JhZGUKfQoKIyDrqqjrk6Ag7JyE67CYIOyhsOqxtOydtCDsl4bsnYQg6rK97Jqw66eMIO2XiOyaqQphbGxvdyB7CiAgICBub3QgZm9yYmlkZGVuX3dvcmRfZGV0ZWN0ZWQKICAgIG5vdCBzZW5zaXRpdmVfdG9waWNfZGV0ZWN0ZWQKICAgIG5vdCBhZ2VfaW5hcHByb3ByaWF0ZQp9Cg=="
                }
            },
            "access_control": {
                "revision": "1.0.0",
                "modules": {
                    "access_control.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5hY2Nlc3NfY29udHJvbAoKIyDsl63tlaAg6riw67CYIOygkeq3vCDsoJzslrQgKFJCQUMpIOygleyxhQpkZWZhdWx0IGFsbG93ID0gZmFsc2UKCiMg6rSA66as7J6QIC0g66qo65OgIOyVoeyFmCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJhZG1pbiIKfQoKIyDqtZDsgqwgLSDroIjsiqgg7J296riwIO2XiOyaqQphbGxvdyB7CiAgICBpbnB1dC51c2VyLnJvbGUgPT0gInRlYWNoZXIiCiAgICBpbnB1dC5yZXNvdXJjZS50eXBlID09ICJsZXNzb24iCiAgICBpbnB1dC5hY3Rpb24gPT0gInJlYWQiCn0KCiMg6rWQ7IKsIC0g66CI7IqoIOyCreygnCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJ0ZWFjaGVyIgogICAgaW5wdXQucmVzb3VyY2UudHlwZSA9PSAibGVzc29uIgogICAgaW5wdXQuYWN0aW9uID09ICJkZWxldGUiCn0KCiMg7ZWZ7IOdIC0g7J6Q6riwIO2VmeuFhOyXkCDrp57ripQg66CI7IqoIOydveq4sCDtl4jsmqkKYWxsb3cgewogICAgaW5wdXQudXNlci5yb2xlID09ICJzdHVkZW50IgogICAgaW5wdXQucmVzb3VyY2UudHlwZSA9PSAibGVzc29uIgogICAgaW5wdXQuYWN0aW9uID09ICJyZWFkIgogICAgaXNfZ3JhZGVfYXBwcm9wcmlhdGUoaW5wdXQudXNlciwgaW5wdXQucmVzb3VyY2UpCn0KCiMgSGVscGVyOiDtlZnsg50g7ZWZ64WE6rO8IOugiOyKqCDtlZnrhYQg67KU7JyEIOqygOyCrAppc19ncmFkZV9hcHByb3ByaWF0ZSh1c2VyLCByZXNvdXJjZSkgewogICAgdXNlci5ncmFkZSA+PSByZXNvdXJjZS5taW5fZ3JhZGUKICAgIHVzZXIuZ3JhZGUgPD0gcmVzb3VyY2UubWF4X2dyYWRlCn0K"
                }
            },
            "approval": {
                "revision": "1.0.0",
                "modules": {
                    "approval_policy.rego": "cGFja2FnZSBkcmVhbXNlZWRhaS5hcHByb3ZhbF9wb2xpY3kKCiMg7Iq57J24IOybjO2BrO2UjOuhnOyasCDsoJXssYU6IOqzoOychO2XmCDslaHshZjsl5Ag64yA7ZWcIOyKueyduCDsmpTqtawKZGVmYXVsdCBhbGxvdyA9IGZhbHNlCgojIOqzoOychO2XmCDslaHshZgg66qp66GdCmhpZ2hfcmlza19hY3Rpb25zID0geyJkZWxldGVfdXNlciIsICJtb2RpZnlfcGVybWlzc2lvbnMiLCAiYWNjZXNzX2NvbmZpZGVudGlhbF9kYXRhIn0KCmhpZ2hfcmlza19hY3Rpb24gewogICAgaW5wdXQuYWN0aW9uICE9IG51bGwKICAgIGhpZ2hfcmlza19hY3Rpb25zW2lucHV0LmFjdGlvbl0KfQoKIyDsirnsnbgg7Jyg7Zqo7ISxIOqygOyCrDog7Iq57J247J6Q6rCAIOq0gOumrOyekOydtOupsCDsirnsnbgg7ZSM656Y6re4IO2ZleyduAphcHByb3ZhbF92YWxpZCB7CiAgICBpbnB1dC5hcHByb3ZhbC5hcHByb3ZlZCA9PSB0cnVlCiAgICBpbnB1dC5hcHByb3ZhbC5hcHByb3Zlci5yb2xlID09ICJhZG1pbiIKfQoKIyDqs6DsnITtl5gg7JWh7IWY7J20IOyVhOuLjCDqsr3smrAg7ZeI7JqpCmFsbG93IHsKICAgIG5vdCBoaWdoX3Jpc2tfYWN0aW9uCn0KCiMg6rOg7JyE7ZeYIOyVoeyFmOyduCDqsr3smrAsIOyKueyduCDsnojsnLzrqbQg7ZeI7JqpCmFsbG93IHsKICAgIGhpZ2hfcmlza19hY3Rpb24KICAgIGFwcHJvdmFsX3ZhbGlkCn0K"
                }
            }
        }
    }