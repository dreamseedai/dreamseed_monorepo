#!/usr/bin/env bash
set -euo pipefail

CFG="/etc/nginx/sites-available/mpcstudy.com.conf"
SUM_BEFORE=$(sha256sum "$CFG" | awk '{print $1}')
sudo nginx -t >/dev/null
sudo systemctl reload nginx
SUM_AFTER=$(sha256sum "$CFG" | awk '{print $1}')

if [ "$SUM_BEFORE" != "$SUM_AFTER" ]; then
  echo "!! mpcstudy vhost changed during reload. investigate."
  exit 1
fi

echo "nginx reloaded safely âœ”"


