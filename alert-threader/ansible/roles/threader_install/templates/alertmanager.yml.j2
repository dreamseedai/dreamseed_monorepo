route:
  receiver: slack-info
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 2m
  repeat_interval: 2h
  routes:
    - receiver: slack-critical
      matchers:
        - severity = "critical"
    - receiver: slack-warning
      matchers:
        - severity = "warning"

receivers:
  - name: slack-critical
    slack_configs:
      - api_url: "{{ lookup('env', 'SLACK_WEBHOOK_URL') }}"
        channel: "#alerts-critical"
        username: "Alertmanager"
        icon_emoji: ":rotating_light:"
        send_resolved: true
        title: "[{{ .CommonLabels.severity | toUpper }}] {{ .CommonAnnotations.summary }}"
        text:  "{{ .CommonAnnotations.description }}"
        color: "#E01E5A"
        mrkdwn_in: ["text", "pretext"]
  - name: slack-warning
    slack_configs:
      - api_url: "{{ lookup('env', 'SLACK_WEBHOOK_URL') }}"
        channel: "#alerts-warning"
        username: "Alertmanager"
        icon_emoji: ":warning:"
        send_resolved: true
        title: "[{{ .CommonLabels.severity | toUpper }}] {{ .CommonAnnotations.summary }}"
        text:  "{{ .CommonAnnotations.description }}"
        color: "#ECB22E"
        mrkdwn_in: ["text", "pretext"]
  - name: slack-info
    slack_configs:
      - api_url: "{{ lookup('env', 'SLACK_WEBHOOK_URL') }}"
        channel: "#alerts-info"
        username: "Alertmanager"
        icon_emoji: ":information_source:"
        send_resolved: true
        title: "[{{ .CommonLabels.severity | toUpper }}] {{ .CommonAnnotations.summary }}"
        text:  "{{ .CommonAnnotations.description }}"
        color: "#2EB67D"
        mrkdwn_in: ["text", "pretext"]

templates:
  - "/etc/alertmanager/templates/*.tmpl"