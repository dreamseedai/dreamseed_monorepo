---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: monitoring

# Alertmanager 리소스
resources:
  - alertmanager-cr.yaml           # Alertmanager CustomResource 정의
  - alertmanager-secret.yaml       # 설정 Secret (alertmanager-main)

# Secret 마운트 보장 패치
patchesStrategicMerge:
  - alertmanager-cr-patch.yaml     # spec.secrets 필수 마운트 보장

# 참고:
# - alertmanager-secrets, pagerduty-routing-key Secret은
#   setup-secrets.sh 또는 External Secrets Operator로 별도 생성
# - Prometheus Operator가 자동으로 Secret을 Pod에 마운트
#   (/etc/alertmanager/secrets/<secret-name>/)
